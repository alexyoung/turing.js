/*!
 * Turing Core
 * Copyright (C) 2010-2011 Alex R. Young
 * MIT Licensed
 *//**
 * A private namespace to set things up against the global object.
 */(function(global){var middleware=[];function turing(){var result,i;for(i=0;i<middleware.length;i++){result=middleware[i].apply(turing,arguments);if(result)return result}}turing.VERSION="0.0.80",turing.lesson="Part 80: Chained Ajax API",turing.alias=global.__turing_alias||"$t",global[turing.alias]=turing,turing.isArray=Array.isArray||function(object){return!!(object&&object.concat&&object.unshift&&!object.callee)},turing.toArray=function(collection){var results=[],i;for(i=0;i<collection.length;i++)results.push(collection[i]);return results},turing.init=function(fn){middleware.unshift(fn)},turing.isNumber=function(object){return object===+object||toString.call(object)==="[object Number]"},turing.bind=function(fn,object){var slice=Array.prototype.slice,args=slice.apply(arguments,[2]);return function(){return fn.apply(object||{},args.concat(slice.apply(arguments)))}};var testCache={},detectionTests={};turing.addDetectionTest=function(name,fn){detectionTests[name]||(detectionTests[name]=fn)},turing.detect=function(testName){return typeof testCache[testCache]=="undefined"&&(testCache[testName]=detectionTests[testName]()),testCache[testName]};if(global.turing)throw new Error("turing has already been defined");global.turing=turing,typeof exports!="undefined"&&(exports.turing=turing)})(typeof window=="undefined"?this:window),turing.Class=function(){return turing.oo.create.apply(this,arguments)},turing.oo={create:function(){var methods=null,parent=undefined,klass=function(){this.$super=function(method,args){return turing.oo.$super(this.$parent,this,method,args)},this.initialize.apply(this,arguments)};return typeof arguments[0]=="function"?(parent=arguments[0],methods=arguments[1]):methods=arguments[0],typeof parent!="undefined"&&(turing.oo.extend(klass.prototype,parent.prototype),klass.prototype.$parent=parent.prototype),turing.oo.mixin(klass,methods),turing.oo.extend(klass.prototype,methods),klass.prototype.constructor=klass,klass.prototype.initialize||(klass.prototype.initialize=function(){}),klass},mixin:function(klass,methods){if(typeof methods.include!="undefined")if(typeof methods.include=="function")turing.oo.extend(klass.prototype,methods.include.prototype);else for(var i=0;i<methods.include.length;i++)turing.oo.extend(klass.prototype,methods.include[i].prototype)},extend:function(destination,source){for(var property in source)destination[property]=source[property];return destination},$super:function(parentClass,instance,method,args){return parentClass[method].apply(instance,args)}},function(){function EnumerableModule(global){global.enumerable={Break:{},each:function(enumerable,callback,context){try{if(Array.prototype.forEach&&enumerable.forEach===Array.prototype.forEach)enumerable.forEach(callback,context);else if(global.isNumber(enumerable.length))for(var i=0,l=enumerable.length;i<l;i++)callback.call(enumerable,enumerable[i],i,enumerable);else for(var key in enumerable)hasOwnProperty.call(enumerable,key)&&callback.call(context,enumerable[key],key,enumerable)}catch(e){if(e!=global.enumerable.Break)throw e}return enumerable},map:function(enumerable,callback,context){if(Array.prototype.map&&enumerable.map===Array.prototype.map)return enumerable.map(callback,context);var results=[];return global.enumerable.each(enumerable,function(value,index,list){results.push(callback.call(context,value,index,list))}),results},filter:function(enumerable,callback,context){if(Array.prototype.filter&&enumerable.filter===Array.prototype.filter)return enumerable.filter(callback,context);var results=[],pushIndex=!global.isArray(enumerable);return global.enumerable.each(enumerable,function(value,index,list){callback.call(context,value,index,list)&&(pushIndex?results.push([index,value]):results.push(value))}),results},reject:function(enumerable,callback,context){return this.filter(enumerable,function(){return!callback.apply(context,arguments)},context)},detect:function(enumerable,callback,context){var result;return global.enumerable.each(enumerable,function(value,index,list){if(callback.call(context,value,index,list))throw result=value,global.enumerable.Break}),result},reduce:function(enumerable,memo,callback,context){return Array.prototype.reduce&&enumerable.reduce===Array.prototype.reduce?enumerable.reduce(global.bind(callback,context),memo):(global.enumerable.each(enumerable,function(value,index,list){memo=callback.call(context,memo,value,index,list)}),memo)},flatten:function(array){return global.enumerable.reduce(array,[],function(memo,value){return global.isArray(value)?memo.concat(global.enumerable.flatten(value)):(memo.push(value),memo)})},tail:function(enumerable,start){return start=typeof start=="undefined"?1:start,Array.prototype.slice.apply(enumerable,[start])},invoke:function(enumerable,method){var args=global.enumerable.tail(arguments,2);return global.enumerable.map(enumerable,function(value){return(method?value[method]:value).apply(value,args)})},pluck:function(enumerable,key){return global.enumerable.map(enumerable,function(value){return value[key]})},some:function(enumerable,callback,context){callback=callback||global.enumerable.identity;if(Array.prototype.some&&enumerable.some===Array.prototype.some)return enumerable.some(callback,context);var result=!1;return global.enumerable.each(enumerable,function(value,index,list){if(result=callback.call(context,value,index,list))throw global.enumerable.Break}),result},all:function(enumerable,callback,context){callback=callback||global.enumerable.identity;if(Array.prototype.every&&enumerable.every===Array.prototype.every)return enumerable.every(callback,context);var result=!0;return global.enumerable.each(enumerable,function(value,index,list){if(!(result=result&&callback.call(context,value,index,list)))throw global.enumerable.Break}),result},include:function(enumerable,target){if(Array.prototype.indexOf&&enumerable.indexOf===Array.prototype.indexOf)return enumerable.indexOf(target)!=-1;var found=!1;return global.enumerable.each(enumerable,function(value,key){if(found=value===target)throw global.enumerable.Break}),found},chain:function(enumerable){return new global.enumerable.Chainer(enumerable)},identity:function(value){return value}},global.enumerable.select=global.enumerable.filter,global.enumerable.collect=global.enumerable.map,global.enumerable.inject=global.enumerable.reduce,global.enumerable.rest=global.enumerable.tail,global.enumerable.any=global.enumerable.some,global.enumerable.every=global.enumerable.all,global.chainableMethods=["map","collect","detect","filter","reduce","each","tail","rest","reject","pluck","any","some","all"],global.enumerable.Chainer=function(values){this.results=values},global.enumerable.Chainer.prototype.values=function(){return this.results},global.enumerable.each(global.chainableMethods,function(methodName){var method=global.enumerable[methodName];global.enumerable.Chainer.prototype[methodName]=function(){var args=Array.prototype.slice.call(arguments);return args.unshift(this.results),this.results=method.apply(this,args),this}}),global.init(function(arg){if(arg.hasOwnProperty.length&&typeof arg!="string")return global.enumerable.chain(arg)})}typeof module!="undefined"?module.exports=function(t){return EnumerableModule(t)}:EnumerableModule(turing)}(),function(){function PromiseModule(global){function Promise(){var self=this;this.pending=[],this.resolve=function(result){self.complete("resolve",result)},this.reject=function(result){self.complete("reject",result)}}Promise.prototype={then:function(success,failure){return this.pending.push({resolve:success,reject:failure}),this},complete:function(type,result){while(this.pending[0])this.pending.shift()[type](result)}};var chain={};global.init(function(){if(arguments.length===0)return chain}),chain.delay=function(ms){var p=new global.Promise;return setTimeout(p.resolve,ms),p},global.Promise=Promise}typeof module!="undefined"?module.exports=function(t){return PromiseModule(t)}:PromiseModule(turing)}(),turing.functional={curry:turing.bind,memoize:function(memo,fn){var wrapper=function(n){var result=memo[n];return typeof result!="number"&&(result=fn(wrapper,n),memo[n]=result),result};return wrapper}},function(){var dom={},InvalidFinder=Error,macros,rules,tokenMap,find,matchMap,findMap,filter,scannerRegExp,nodeTypes,getStyle,setStyle,cssNumericalProperty,propertyFix,getAttributeParamFix,booleanAttributes;macros={nl:"\n|\r\n|\r|\f",w:"[s\r\n\f]*",nonascii:"[^ -]",num:"-?([0-9]+|[0-9]*.[0-9]+)",unicode:"\\[0-9A-Fa-f]{1,6}(\r\n|[s\n\r\t\f])?",escape:"#{unicode}|\\[^\n\r\f0-9A-Fa-f]",nmchar:"[_A-Za-z0-9-]|#{nonascii}|#{escape}",nmstart:"[_A-Za-z]|#{nonascii}|#{escape}",ident:"[-@]?(#{nmstart})(#{nmchar})*",name:"(#{nmchar})+",string1:'"([^\n\r\f"]|#{nl}|#{nonascii}|#{escape})*"',string2:"'([^\n\r\f']|#{nl}|#{nonascii}|#{escape})*'",string:"#{string1}|#{string2}"},nodeTypes={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},cssNumericalProperty={zIndex:!0,fontWeight:!0,opacity:!0,zoom:!0,lineHeight:!0},booleanAttributes={selected:!0,readonly:!0,checked:!0},rules={"name and id":"(#{ident}##{ident})",id:"(##{ident})","class":"(\\.#{ident})","name and class":"(#{ident}\\.#{ident})",element:"(#{ident})","pseudo class":"(:#{ident})"},propertyFix={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},getAttributeParamFix={width:!0,height:!0,src:!0,href:!0},turing.addDetectionTest("classList",function(){var div=document.createElement("div");return div.classList?!0:(div=null,!1)});function scanner(){function replacePattern(pattern,patterns){var matched=!0,match;while(matched)match=pattern.match(/#\{([^}]+)\}/),match&&match[1]?(pattern=pattern.replace(new RegExp("#{"+match[1]+"}","g"),patterns[match[1]]),matched=!0):matched=!1;return pattern}function escapePattern(text){return text.replace(/\//g,"//")}function convertPatterns(){var key,pattern,results={},patterns,source;arguments.length===2?(source=arguments[0],patterns=arguments[1]):(source=arguments[0],patterns=arguments[0]);for(key in patterns)pattern=escapePattern(replacePattern(patterns[key],source)),results[key]=pattern;return results}function joinPatterns(regexps){var results=[],key;for(key in regexps)results.push(regexps[key]);return new RegExp(results.join("|"),"g")}return joinPatterns(convertPatterns(convertPatterns(macros),rules))}scannerRegExp=scanner(),find={byId:function(root,id){return root===null?[]:[root.getElementById(id)]},byNodeName:function(root,tagName){if(root===null)return[];var i,results=[],nodes=root.getElementsByTagName(tagName);for(i=0;i<nodes.length;i++)results.push(nodes[i]);return results},byClassName:function(root,className){if(root===null)return[];var i,results=[],nodes=root.getElementsByTagName("*");for(i=0;i<nodes.length;i++)nodes[i].className.match("\\b"+className+"\\b")&&results.push(nodes[i]);return results}},findMap={id:function(root,selector){return selector=selector.split("#")[1],find.byId(root,selector)},"name and id":function(root,selector){var matches=selector.split("#"),name,id;return name=matches[0],id=matches[1],filter.byAttr(find.byId(root,id),"nodeName",name.toUpperCase())},name:function(root,selector){return find.byNodeName(root,selector)},"class":function(root,selector){return selector=selector.split(".")[1],find.byClassName(root,selector)},"name and class":function(root,selector){var matches=selector.split("."),name,className;return name=matches[0],className=matches[1],filter.byAttr(find.byClassName(root,className),"nodeName",name.toUpperCase())}},typeof document!="undefined"&&typeof document.getElementsByClassName!="undefined"&&(find.byClassName=function(root,className){return root.getElementsByClassName(className)}),filter={byAttr:function(elements,attribute,value){var key,results=[];for(key in elements)elements[key]&&elements[key][attribute]===value&&results.push(elements[key]);return results}},matchMap={id:function(element,selector){return selector=selector.split("#")[1],element&&element.id===selector},name:function(element,nodeName){return element.nodeName===nodeName.toUpperCase()},"name and id":function(element,selector){return matchMap.id(element,selector)&&matchMap.name(element,selector.split("#")[0])},"class":function(element,selector){if(element&&element.className)return selector=selector.split(".")[1],element.className.match("\\b"+selector+"\\b")},"name and class":function(element,selector){return matchMap["class"](element,selector)&&matchMap.name(element,selector.split(".")[0])}};function Searcher(root,tokens){this.root=root,this.key_selector=tokens.pop(),this.tokens=tokens,this.results=[]}Searcher.prototype.matchesToken=function(element,token){if(!matchMap[token.finder])throw new InvalidFinder("Invalid matcher: "+token.finder);return matchMap[token.finder](element,token.identity)},Searcher.prototype.find=function(token){if(!findMap[token.finder])throw new InvalidFinder("Invalid finder: "+token.finder);return findMap[token.finder](this.root,token.identity)},Searcher.prototype.matchesAllRules=function(element){if(this.tokens.length===0)return;var i=this.tokens.length-1,token=this.tokens[i],matchFound=!1;while(i>=0&&element)this.matchesToken(element,token)&&(matchFound=!0,i--,token=this.tokens[i]),element=element.parentNode;return matchFound&&i<0},Searcher.prototype.parse=function(){var i,element,elements=this.find(this.key_selector),results=[];for(i=0;i<elements.length;i++)element=elements[i],this.tokens.length>0?this.matchesAllRules(element.parentNode)&&results.push(element):this.matchesToken(element,this.key_selector)&&results.push(element);return results},Searcher.prototype.values=function(){return this.results};function normalize(text){return text.replace(/^\s+|\s+$/g,"").replace(/[ \t\r\n\f]+/g," ")}function Token(identity,finder){this.identity=identity,this.finder=finder}Token.prototype.toString=function(){return"identity: "+this.identity+", finder: "+this.finder};function Tokenizer(selector){this.selector=normalize(selector),this.tokens=[],this.tokenize()}Tokenizer.prototype.tokenize=function(){var match,r,finder;r=scannerRegExp,r.lastIndex=0;while(match=r.exec(this.selector))finder=null,match[10]?finder="id":match[1]?finder="name and id":match[29]?finder="name":match[15]?finder="class":match[20]&&(finder="name and class"),this.tokens.push(new Token(match[0],finder));return this.tokens},Tokenizer.prototype.finders=function(){var i,results=[];for(i in this.tokens)results.push(this.tokens[i].finder);return results},dom.tokenize=function(selector){var tokenizer=new Tokenizer(selector);return tokenizer};function get(selector,root){var tokens=dom.tokenize(selector).tokens,searcher=new Searcher(root,tokens);return searcher.parse()}turing.addDetectionTest("querySelectorAll",function(){var div=document.createElement("div");return div.innerHTML='<p class="TEST"></p>',div.querySelectorAll?div.querySelectorAll(".TEST").length===0?!1:!0:(div=null,!1)});function camelCase(text){if(typeof text!="string")return;return text.replace(/-([a-z])/ig,function(all,letter){return letter.toUpperCase()})}function uncamel(text){if(typeof text!="string")return;return text.replace(/([A-Z])/g,"-$1").toLowerCase()}function invalidCSSNode(element){return!element||element.nodeType===nodeTypes.TEXT_NODE||element.nodeType===nodeTypes.COMMENT_NODE||!element.style}function setStyleProperty(element,property,value){if(invalidCSSNode(element))return;typeof value=="number"&&!cssNumericalProperty[property]&&(value+="px"),element.style[property]=value}typeof document!="undefined"&&(document.documentElement.currentStyle?(getStyle=function(element,property){return element.currentStyle[camelCase(property)]},setStyle=function(element,property,value){return setStyleProperty(element,camelCase(property),value)}):document.defaultView.getComputedStyle&&(getStyle=function(element,property){return element.ownerDocument.defaultView.getComputedStyle(element,null).getPropertyValue(uncamel(property))},setStyle=function(element,property,value){return setStyleProperty(element,uncamel(property),value)})),dom.css=function(element,options){if(typeof options=="string")return getStyle(element,options);for(var property in options)options.hasOwnProperty(property)&&setStyle(element,property,options[property])},dom.get=function(selector){var root=typeof arguments[1]=="undefined"?document:arguments[1];return turing.toArray(turing.detect("querySelectorAll")?root.querySelectorAll(selector):get(selector,root))},dom.findElement=function(element,selector,root){var tokens=dom.tokenize(selector).tokens,searcher=new Searcher(root,[]);searcher.tokens=tokens;while(element){if(searcher.matchesAllRules(element))return element;element=element.parentNode}};function manipulateDOM(element,html,callback){var context=document,isTable=element.nodeName==="TABLE",shim,div;div=context.createElement("div"),div.innerHTML="<"+element.nodeName+">"+html+"</"+element.nodeName+">",shim=isTable?div.lastChild.lastChild:div.lastChild,callback(isTable?element.lastChild:element,shim),div=null}function getText(elements){var results="",element,i;for(i=0;elements[i];i++)element=elements[i],element.nodeType===nodeTypes.TEXT_NODE||element.nodeType===nodeTypes.CDATA_SECTION_NODE?results+=element.nodeValue:element.nodeType!==nodeTypes.COMMENT_NODE&&(results+=getText(element.childNodes));return results}dom.replace=function(element,html){manipulateDOM(element,html,function(insert,shim){element.replaceChild(shim,insert)})},dom.append=function(element,html){manipulateDOM(element,html,function(insertTo,shim){insertTo.appendChild(shim.firstChild)})},dom.html=function(element,html){if(arguments.length===1)return element.innerHTML;try{element.innerHTML=html}catch(e){dom.replace(element,html)}},dom.text=function(element,text){if(arguments.length===1)return getText(element);dom.empty(element),element.appendChild(document.createTextNode(text))},dom.empty=function(element){while(element.firstChild)element.removeChild(element.firstChild)},turing.detect("classList")?dom.hasClass=function(element,className){return element.classList.contains(className)}:dom.hasClass=function(element,className){return(" "+element.className+" ").indexOf(" "+className+" ")!==-1},dom.addClass=function(element,className){if(!className||typeof className!="string")return;if(element.nodeType!==nodeTypes.ELEMENT_NODE)return;if(element.classList)return element.classList.add(className);element.className&&element.className.length?element.className.match("\\b"+className+"\\b")||(element.className+=" "+className):element.className=className},dom.removeClass=function(element,className){if(!className||typeof className!="string")return;if(element.nodeType!==nodeTypes.ELEMENT_NODE)return;if(element.classList)return element.classList.remove(className);element.className&&(element.className=element.className.replace(new RegExp("\\s?\\b"+className+"\\b"),"").replace(/^\s+/,""))},turing.addDetectionTest("getAttribute",function(){var div=document.createElement("div");return div.innerHTML='<a href="/example"></a>',div.childNodes[0].getAttribute("href")==="/example"?!0:(div=null,!1)});function getAttribute(element,name){return propertyFix[name]&&(name=propertyFix[name]),getAttributeParamFix[name]?element.getAttribute(name,2):name==="value"&&element.nodeName==="BUTTON"?element.getAttributeNode(name).nodeValue:booleanAttributes[name]?element[name]?name:undefined:element.getAttribute(name)}function setAttribute(element,name,value){return propertyFix[name]&&(name=propertyFix[name]),name==="value"&&element.nodeName==="BUTTON"?element.getAttributeNode(name).nodeValue=value:element.setAttribute(name,value)}function removeAttribute(element,name){if(element.nodeType!==nodeTypes.ELEMENT_NODE)return;propertyFix[name]&&(name=propertyFix[name]),setAttribute(element,name,""),element.removeAttributeNode(element.getAttributeNode(name))}dom.removeAttr=function(element,attribute){turing.detect("getAttribute")?element.removeAttribute(attribute):removeAttribute(element,attribute)},dom.attr=function(element,attribute,value){return typeof value=="undefined"?turing.detect("getAttribute")?element.getAttribute(attribute):getAttribute(element,attribute):value===null?dom.removeAttr(element,attribute):turing.detect("getAttribute")?element.setAttribute(attribute,value):setAttribute(element,attribute,value)},dom.prop=function(element,property,value){return propertyFix[property]&&(property=propertyFix[property]),typeof value=="undefined"?element[property]:value===null?dom.removeProperty(element,property):element[property]=value},dom.removeProp=function(element,property){propertyFix[property]&&(property=propertyFix[property]);try{element[property]=undefined,delete element[property]}catch(e){}},turing.init(function(arg){if(typeof arg=="string"||typeof arg=="undefined")return turing.domChain.init(arg)}),turing.domChain={init:function(selector){return this.selector=selector,this.length=0,this.prevObject=null,this.elements=[],selector?this.find(selector):this},writeElements:function(){for(var i=0;i<this.elements.length;i++)this[i]=this.elements[i]},first:function(){var elements=[],ret=turing.domChain;return ret.elements=this.elements.length===0?[]:[this.elements[0]],ret.selector=this.selector,ret.length=ret.elements.length,ret.prevObject=this,ret.writeElements(),ret},html:function(html){if(arguments.length===0)return this.elements.length===0?null:dom.html(this[0]);for(var i=0;i<this.elements.length;i++)dom.html(this[i],html);return this},text:function(text){if(arguments.length===0)return this.elements.length===0?null:getText(this.elements);for(var i=0;i<this.elements.length;i++)dom.text(this.elements[i],text);return this},css:function(options){if(typeof options=="string")return this.elements.length>0?getStyle(this.elements[0],options):null;for(var i=0;i<this.elements.length;i++)dom.css(this[i],options);return this},addClass:function(className){for(var i=0;i<this.elements.length;i++)dom.addClass(this[i],className);return this},hasClass:function(className){for(var i=0;i<this.length;i++)if(dom.hasClass(this[i],className))return!0;return!1},removeClass:function(className){for(var i=0;i<this.elements.length;i++)dom.removeClass(this[i],className);return this},attr:function(attribute,value){if(this.elements.length>0)return dom.attr(this[0],attribute,value)},removeAttr:function(attribute){return this.elements.length>0&&dom.removeAttr(this[0],attribute),this},prop:function(property,value){if(this.elements.length>0)return dom.prop(this[0],property,value)},removeProp:function(property){if(this.elements.length>0)return dom.removeProp(this[0],property,value)},append:function(html){for(var i=0;i<this.elements.length;i++)dom.append(this[i],html);return this},find:function(selector){var elements=[],ret=turing.domChain,root=document;return this.prevObject&&(this.prevObject.elements.length>0?root=this.prevObject.elements[0]:root=null),elements=dom.get(selector,root),this.elements=elements,ret.elements=elements,ret.selector=selector,ret.length=elements.length,ret.prevObject=this,ret.writeElements(),ret}},turing.domChain.init.prototype=turing.domChain,typeof turing.enumerable!="undefined"&&(turing.domChain.values=function(){return this.elements},turing.enumerable.each(turing.chainableMethods,function(methodName){turing.domChain[methodName]=function(fn){var elements=turing.enumerable[methodName](this,fn),ret=turing.domChain;return this.elements=elements,ret.elements=elements,ret.selector=this.selector,ret.length=elements.length,ret.prevObject=this,ret.writeElements(),ret}})),dom.nodeTypes=nodeTypes,turing.dom=dom}(),function(){var plugins={};plugins.registered={},plugins.AlreadyRegistered=Error,plugins.NotFound=Error,plugins.register=function(methodName,metadata){if(plugins.registered[methodName])throw new plugins.AlreadyRegistered("Already registered a plugin called: "+methodName);plugins.registered[methodName]=metadata,turing.domChain[methodName]=metadata[methodName]},plugins.remove=function(methodName){if(!plugins.registered.hasOwnProperty(methodName))throw new plugins.NotFound("Plugin not found: "+methodName);delete plugins.registered[methodName],delete turing.domChain[methodName]},turing.plugins=plugins}(),function(){var events={},cache=[],onReadyBound=!1,isReady=!1,DOMContentLoaded,readyCallbacks=[],Emitter;function isValidElement(element){return element.nodeType!==3&&element.nodeType!==8}function stop(event){event.preventDefault(event),event.stopPropagation(event)}function fix(event,element){if(!event)var event=window.event;event.stop=function(){stop(event)},typeof event.target=="undefined"&&(event.target=event.srcElement||element),event.preventDefault||(event.preventDefault=function(){event.returnValue=!1}),event.stopPropagation||(event.stopPropagation=function(){event.cancelBubble=!0}),event.target&&event.target.nodeType===3&&(event.target=event.target.parentNode);if(event.pageX==null&&event.clientX!=null){var doc=document.documentElement,body=document.body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}return event}function createResponder(element,handler){return function(event){return fix(event,element),handler(event)}}function removeCachedResponder(element,type,handler){var i=0,responder,j=0;for(j=0;j<cache.length;j++)cache[j].element!==element&&cache[j].type!==type&&cache[j].handler!==handler?cache[i++]=cache[j]:responder=cache[j].responder;return cache.length=i,responder}function ready(){if(!isReady){if(!document.body)return setTimeout(ready,13);isReady=!0;for(var i in readyCallbacks)readyCallbacks[i]();readyCallbacks=null}}function DOMReadyScrollCheck(){if(isReady)return;try{document.documentElement.doScroll("left")}catch(e){setTimeout(DOMReadyScrollCheck,1);return}ready()}typeof document!="undefined"&&(document.addEventListener?DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,!1),ready()}:document.attachEvent&&(DOMContentLoaded=function(){document.readyState==="complete"&&(document.detachEvent("onreadystatechange",DOMContentLoaded),ready())}));function bindOnReady(){if(onReadyBound)return;onReadyBound=!0;if(document.readyState==="complete")ready();else if(document.addEventListener)document.addEventListener("DOMContentLoaded",DOMContentLoaded,!1),window.addEventListener("load",ready,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",DOMContentLoaded),window.attachEvent("onload",ready);var toplevel=!1;try{toplevel=window.frameElement==null}catch(e){}document.documentElement.doScroll&&toplevel&&DOMReadyScrollCheck()}}function IEType(type){return type.match(/:/)?type:"on"+type}events.add=function(element,type,handler){if(!isValidElement(element))return;var responder=createResponder(element,handler);cache.push({element:element,type:type,handler:handler,responder:responder}),type.match(/:/)&&element.attachEvent?element.attachEvent("ondataavailable",responder):element.addEventListener?element.addEventListener(type,responder,!1):element.attachEvent&&element.attachEvent(IEType(type),responder)},events.remove=function(element,type,handler){if(!isValidElement(element))return;var responder=removeCachedResponder(element,type,handler);document.removeEventListener?element.removeEventListener(type,responder,!1):element.detachEvent(IEType(type),responder)},events.fire=function(element,type){var event;return document.createEventObject?(event=document.createEventObject(),fix(event,element),type.match(/:/)?(event.eventName=type,event.eventType="ondataavailable",element.fireEvent(event.eventType,event)):element.fireEvent(IEType(type),event)):(event=document.createEvent("HTMLEvents"),fix(event,element),event.eventName=type,event.initEvent(type,!0,!0),!element.dispatchEvent(event))},events.ready=function(callback){bindOnReady(),readyCallbacks.push(callback)},turing.dom!=="undefined"&&(events.delegate=function(element,selector,type,handler){return events.add(element,type,function(event){var matches=turing.dom.findElement(event.target,selector,event.currentTarget);matches&&handler(event)})}),events.addDOMethods=function(){if(typeof turing.domChain=="undefined")return;turing.domChain.bind=function(type,handler){var element;for(var i=0;i<this.length;i++)element=this[i],handler?turing.events.add(element,type,handler):turing.events.fire(element,type);return this};var chainedAliases="click dblclick mouseover mouseout mousemove mousedowe mouseup blur focus change keydown keypress keyup resize scroll".split(" ");for(var i=0;i<chainedAliases.length;i++)(function(name){turing.domChain[name]=function(handler){return this.bind(name,handler)}})(chainedAliases[i])},events.addDOMethods(),Emitter=function(){this.events={}},Emitter.prototype={addListener:function(eventName,handler){eventName in this.events==!1&&(this.events[eventName]=[]),this.events[eventName].push(handler)},emit:function(eventName){var fired=!1;if(eventName in this.events==!1)return fired;var list=this.events[eventName].slice();for(var i=0;i<list.length;i++)list[i].apply(this,Array.prototype.slice.call(arguments,1)),fired=!0;return fired},removeAllListeners:function(eventName){return eventName in this.events==!1?!1:(delete this.events[eventName],!0)},removeListenerAt:function(eventName,i){this.events[eventName].splice(i,1)},removeListener:function(eventName,handler){if(eventName in this.events==!1)return!1;for(var i=0;i<this.events[eventName].length;i++)if(this.events[eventName][i]==handler)return this.removeListenerAt(eventName,i),!0;return!1}},Emitter.prototype.on=Emitter.prototype.addListener,events.Emitter=Emitter,turing.ready=events.ready,turing.events=events,turing.init(function(arg){arguments.length===1&&typeof arguments[0]=="function"&&turing.events.ready(arguments[0])}),typeof window!="undefined"&&window.attachEvent&&!window.addEventListener&&window.attachEvent("onunload",function(){for(var i=0;i<cache.length;i++)try{events.remove(cache[i].element,cache[i].type),cache[i]=null}catch(e){}})}(),function(){var net={},trim="".trim?function(s){return s.trim()}:function(s){return s.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};function xhr(){if(typeof XMLHttpRequest=="undefined"||window.location.protocol==="file:"&&!!window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1}return new XMLHttpRequest}function successfulRequest(request){return request.status>=200&&request.status<300||request.status==304||request.status==0&&request.responseText}net.serialize=function(object){if(!object)return;if(typeof object=="string")return object;var results=[];for(var key in object)results.push(encodeURIComponent(key)+"="+encodeURIComponent(object[key]));return results.join("&")},turing.addDetectionTest("JSON.parse",function(){return window.JSON&&window.JSON.parse}),net.parseJSON=function(string){return typeof string!="string"||!string?null:(string=trim(string),turing.detect("JSON.parse")?window.JSON.parse(string):(new Function("return "+string))())},window.DOMParser?net.parseXML=function(text){return(new DOMParser).parseFromString(text,"text/xml")}:net.parseXML=function(text){var xml=new ActiveXObject("Microsoft.XMLDOM");return xml.async="false",xml.loadXML(text),xml};function ajax(url,options){var request=xhr(),promise,then,response={},chain;turing.Promise&&(promise=new turing.Promise);function respondToReadyState(readyState){if(request.readyState==4){var contentType=request.mimeType||request.getResponseHeader("content-type")||"";response.status=request.status,response.responseText=request.responseText,/json/.test(contentType)?response.responseJSON=net.parseJSON(request.responseText):/xml/.test(contentType)&&(response.responseXML=net.parseXML(request.responseText)),response.success=successfulRequest(request);if(options.callback)return options.callback(response,request);response.success?(options.success&&options.success(response,request),promise&&promise.resolve(response,request)):(options.error&&options.error(response,request),promise&&promise.reject(response,request))}}function setHeaders(){var defaults={Accept:"text/javascript, application/json, text/html, application/xml, text/xml, */*"
,"Content-Type":"application/x-www-form-urlencoded"};for(var name in defaults)options.headers.hasOwnProperty(name)||(options.headers[name]=defaults[name]);for(var name in options.headers)request.setRequestHeader(name,options.headers[name])}typeof options=="undefined"&&(options={}),options.method=options.method?options.method.toLowerCase():"get",options.asynchronous=options.asynchronous||!0,options.postBody=options.postBody||"",request.onreadystatechange=respondToReadyState,request.open(options.method,url,options.asynchronous),options.headers=options.headers||{},options.contentType&&(options.headers["Content-Type"]=options.contentType),typeof options.postBody!="string"&&(options.postBody=net.serialize(options.postBody)),setHeaders();function send(){try{request.send(options.postBody)}catch(e){options.error&&options.error()}}return chain={set:function(key,value){return options.headers[key]=value,chain},send:function(data,callback){return options.postBody=net.serialize(data),options.callback=callback,send(),chain},end:function(callback){return options.callback=callback,send(),chain},data:function(data){return options.postBody=net.serialize(data),chain},then:function(){return chain.end(),promise&&promise.then.apply(promise,arguments),chain}},chain}function JSONPCallback(url,success,failure){var self=this;this.url=url,this.methodName="__turing_jsonp_"+parseInt((new Date).getTime()),this.success=success,this.failure=failure;function runCallback(json){self.success(json),self.teardown()}window[this.methodName]=runCallback}JSONPCallback.prototype.run=function(){this.scriptTag=document.createElement("script"),this.scriptTag.id=this.methodName,this.scriptTag.src=this.url.replace("{callback}",this.methodName),document.body.appendChild(this.scriptTag)},JSONPCallback.prototype.teardown=function(){window[this.methodName]=null,delete window[this.methodName],this.scriptTag&&document.body.removeChild(this.scriptTag)},net.get=function(url,options){return typeof options=="undefined"&&(options={}),options.method="get",ajax(url,options)},net.post=function(url,options){return typeof options=="undefined"&&(options={}),options.method="post",ajax(url,options)},net.jsonp=function(url,options){typeof options=="undefined"&&(options={});var callback=new JSONPCallback(url,options.success,options.failure);callback.run()},turing.get=net.get,turing.post=net.post,turing.jsonp=net.jsonp,net.ajax=ajax,turing.net=net}(),function(){var touch={},state={};touch.swipeThreshold=50,touch.orientation=function(){var orientation=window.orientation,orientationString="";switch(orientation){case 0:orientationString+="portrait";break;case-90:orientationString+="landscape right";break;case 90:orientationString+="landscape left";break;case 180:orientationString+="portrait upside-down"}return[orientation,orientationString]};function touchStart(e){state.touches=e.touches,state.startTime=(new Date).getTime(),state.x=e.changedTouches[0].clientX,state.y=e.changedTouches[0].clientY,state.startX=state.x,state.startY=state.y,state.target=e.target,state.duration=0}function touchEnd(e){var x=e.changedTouches[0].clientX,y=e.changedTouches[0].clientY;state.x===x&&state.y===y&&state.touches.length==1&&turing.events.fire(e.target,"tap")}function touchMove(e){var moved=0,touch=e.changedTouches[0];state.duration=(new Date).getTime()-state.startTime,state.x=state.startX-touch.pageX,state.y=state.startY-touch.pageY,moved=Math.sqrt(Math.pow(Math.abs(state.x),2)+Math.pow(Math.abs(state.y),2)),state.duration<1e3&&moved>turing.touch.swipeThreshold&&turing.events.fire(e.target,"swipe")}touch.register=function(){turing.events.add(document,"touchstart",touchStart),turing.events.add(document,"touchmove",touchMove),turing.events.add(document,"touchend",touchEnd),turing.touch.swipeThreshold=screen.width/5},turing.touch=touch}(),function(){var anim={},easing={},Chainer,opacityType,methodName,CSSTransitions={};function camelize(property){return property.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():""})}function getOpacityType(){return typeof document.body.style.opacity!="undefined"?"opacity":"filter"}function Colour(value){this.r=0,this.g=0,this.b=0,this.value=this.normalise(value),this.parse()}Colour.matchers=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(bits){return[parseInt(bits[1],10),parseInt(bits[2],10),parseInt(bits[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(bits){return[parseInt(bits[1],16),parseInt(bits[2],16),parseInt(bits[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(bits){return[parseInt(bits[1]+bits[1],16),parseInt(bits[2]+bits[2],16),parseInt(bits[3]+bits[3],16)]}}],Colour.prototype.normalise=function(value){return value.replace(/ /g,""),value.charAt(0)==="#"&&(value=value.substr(1,6)),value},Colour.prototype.parse=function(){var channels=[],i;for(i=0;i<Colour.matchers.length;i++){channels=this.value.match(Colour.matchers[i].re);if(channels){channels=Colour.matchers[i].process(channels),this.r=channels[0],this.g=channels[1],this.b=channels[2];break}}this.validate()},Colour.prototype.validate=function(){this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b},Colour.prototype.sum=function(){return this.r+this.g+this.b},Colour.prototype.toString=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};function isColour(value){return typeof value=="string"&&value.match(/(#[a-f|A-F|0-9]|rgb)/)}function parseColour(value){return{value:new Colour(value),units:"",transform:colourTransform}}function numericalTransform(parsedValue,position,easingFunction){return easingFunction(position)*parsedValue.value}function colourTransform(v,position,easingFunction){var colours=[];return colours[0]=Math.round(v.base.r+v.direction[0]*Math.abs(v.base.r-v.value.r)*easingFunction(position)),colours[1]=Math.round(v.base.g+v.direction[1]*Math.abs(v.base.g-v.value.g)*easingFunction(position)),colours[2]=Math.round(v.base.b+v.direction[2]*Math.abs(v.base.b-v.value.b)*easingFunction(position)),"rgb("+colours.join(", ")+")"}function parseNumericalValue(value){var n=typeof value=="string"?parseFloat(value):value,units=typeof value=="string"?value.replace(n,""):"";return{value:n,units:units,transform:numericalTransform}}function parseCSSValue(value,element,property){if(isColour(value)){var colour=parseColour(value),i;return colour.base=new Colour(element.style[property]),colour.direction=[colour.base.r<colour.value.r?1:-1,colour.base.g<colour.value.g?1:-1,colour.base.b<colour.value.b?1:-1],colour}return typeof value!="object"?parseNumericalValue(value):value}function setCSSProperty(element,property,value){return property==="opacity"&&opacityType==="filter"?(element.style[opacityType]="alpha(opacity="+Math.round(value*100)+")",element):(element.style[property]=value,element)}easing.linear=function(position){return position},easing.sine=function(position){return-Math.cos(position*Math.PI)/2+.5},easing.reverse=function(position){return 1-position},easing.spring=function(position){return 1-Math.cos(position*Math.PI*4)*Math.exp(-position*6)},easing.bounce=function(position){return position<1/2.75?7.6*position*position:position<2/2.75?7.6*(position-=1.5/2.75)*position+.74:position<2.5/2.75?7.6*(position-=2.25/2.75)*position+.91:7.6*(position-=2.625/2.75)*position+.98},anim.animate=function(element,duration,properties,options){var start=(new Date).valueOf(),finish=start+duration,easingFunction=easing.linear,interval,p;opacityType||(opacityType=getOpacityType()),options=options||{},options.hasOwnProperty("easing")&&(typeof options.easing=="string"?easingFunction=easing[options.easing]:options.easing&&(easingFunction=options.easing));function transition(){CSSTransitions.end(element,property)}for(p in properties)if(properties.hasOwnProperty(p)){properties[p]=parseCSSValue(properties[p],element,p);if(p==="opacity"&&opacityType==="filter")element.style.zoom=1;else if(CSSTransitions.vendorPrefix&&(p==="left"||p==="top")){CSSTransitions.start(element,duration,p,properties[p].value+properties[p].units,options.easing),setTimeout(transition,duration);return}}interval=setInterval(function(){var time=(new Date).valueOf(),position=time>finish?1:(time-start)/duration,property;for(property in properties)properties.hasOwnProperty(property)&&setCSSProperty(element,property,properties[property].transform(properties[property],position,easingFunction)+properties[property].units);time>finish&&clearInterval(interval)},10)},CSSTransitions={vendors:{opera:{prefix:"-o-",detector:function(){try{return document.createEvent("OTransitionEvent"),!0}catch(e){return!1}}},webkit:{prefix:"-webkit-",detector:function(){try{return document.createEvent("WebKitTransitionEvent"),!0}catch(e){return!1}}},firefox:{prefix:"-moz-",detector:function(){var div=document.createElement("div"),supported=!1;return typeof div.style.MozTransition!="undefined"&&(supported=!0),div=null,supported}}},findCSS3VendorPrefix:function(){var detector;for(detector in CSSTransitions.vendors)if(this.vendors.hasOwnProperty(detector)){detector=this.vendors[detector];if(detector.detector())return detector.prefix}},vendorPrefix:null,start:function(element,duration,property,value,easing){element.style[camelize(this.vendorPrefix+"transition")]=property+" "+duration+"ms "+(easing||"linear"),element.style[property]=value},end:function(element,property){element.style[camelize(this.vendorPrefix+"transition")]=null}},CSSTransitions.vendorPrefix=CSSTransitions.findCSS3VendorPrefix(),anim.fade=function(element,duration,options){return element.style.opacity=options.from,anim.animate(element,duration,{opacity:options.to},{easing:options.easing})},anim.fadeIn=function(element,duration,options){return options=options||{},options.from=options.from||0,options.to=options.to||1,anim.fade(element,duration,options)},anim.fadeOut=function(element,duration,options){var from;return options=options||{},options.from=options.from||1,options.to=options.to||0,from=options.from,options.from=options.to,options.to=from,options.easing=function(p){return 1-p+options.from},anim.fade(element,duration,options)},anim.highlight=function(element,duration,options){var style=element.currentStyle?element.currentStyle:getComputedStyle(element,null);return options=options||{},options.from=options.from||"#ff9",options.to=options.to||style.backgroundColor,options.easing=options.easing||easing.sine,duration=duration||500,element.style.backgroundColor=options.from,setTimeout(function(){anim.animate(element,duration,{backgroundColor:options.to,easing:options.easing})},200)},anim.move=function(element,duration,options){return anim.animate(element,duration,{left:options.x,top:options.y},{easing:options.easing||easing.sine})},anim.parseColour=function(colourString){return new Colour(colourString)},anim.pause=function(element,duration,options){},anim.easing=easing,Chainer=function(element){this.element=element,this.position=0};function makeChain(m){var method=anim[m];Chainer.prototype[m]=function(){var args=Array.prototype.slice.call(arguments);return args.unshift(this.element),this.position+=args[1]||0,setTimeout(function(){method.apply(null,args)},this.position),this}}for(methodName in anim)anim.hasOwnProperty(methodName)&&makeChain(methodName);anim.chain=function(element){return new Chainer(element)},anim.addDOMethods=function(){if(typeof turing.domChain=="undefined")return;var chainedAliases="animate fade fadeIn fadeOut highlight move parseColour pause easing".split(" "),i;function makeChainedAlias(name){turing.domChain[name]=function(handler){var j,args=turing.toArray(arguments);args.unshift(null);for(j=0;j<this.length;j++)args[0]=this[j],anim[name].apply(this,args);return this}}for(i=0;i<chainedAliases.length;i++)makeChainedAlias(chainedAliases[i])},anim.addDOMethods(),turing.anim=anim}()